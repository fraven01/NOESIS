{% extends 'base.html' %}
{% block title %}Anlage hochladen{% endblock %}
{% block content %}
<h1 class="text-2xl font-semibold mb-4">Anlage hochladen f\u00fcr {{ projekt.title }}</h1>
<form method="post" enctype="multipart/form-data" class="space-y-4"
      hx-post="{% url 'projekt_file_upload' projekt.pk %}"
      hx-target="#anlage-tab-content" hx-swap="innerHTML" hx-encoding="multipart/form-data">
    {% csrf_token %}
    {{ form.non_field_errors }}
    <div>
        {{ form.anlage_nr.label_tag }}<br>
        {{ form.anlage_nr }}
        {{ form.anlage_nr.errors }}
    </div>
    <div>
        {{ form.upload }}
        <div id="dropzone" class="border-2 border-dashed p-6 text-center cursor-pointer">
            Dateien hierher ziehen oder klicken, um auszuw√§hlen
        </div>
        <div id="preview-container" class="mt-2 space-y-2"></div>
        {{ form.upload.errors }}
    </div>
    {% if form.parser_mode %}
    <div>
        {{ form.parser_mode.label_tag }}<br>
        {{ form.parser_mode }}
        {{ form.parser_mode.errors }}
    </div>
    <div>
        {{ form.parser_order.label_tag }}<br>
        {{ form.parser_order }}
        {{ form.parser_order.errors }}
    </div>
    {% endif %}
    <div>
        {{ form.manual_comment.label_tag }}<br>
        {{ form.manual_comment }}
        {{ form.manual_comment.errors }}
    </div>
    {% if form.manual_analysis_json %}
    <div>
        {{ form.manual_analysis_json.label_tag }}<br>
        {{ form.manual_analysis_json }}
        {{ form.manual_analysis_json.errors }}
    </div>
    {% endif %}
    <div>
        {{ form.manual_reviewed }} {{ form.manual_reviewed.label_tag }}
        {{ form.manual_reviewed.errors }}
    </div>
    <div>
        {{ form.verhandlungsfaehig }} {{ form.verhandlungsfaehig.label_tag }}
        {{ form.verhandlungsfaehig.errors }}
    </div>
<button type="submit" class="bg-blue-600 text-white px-4 py-2 rounded">Speichern</button>
</form>
{% endblock %}

{% block extra_js %}
<script>
document.addEventListener('DOMContentLoaded', function () {
    if (window.initFileUpload) {
        initFileUpload();
    }
});
</script>
{% endblock %}
