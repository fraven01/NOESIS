{% if anlage.anlage_nr == 3 %}
  {% url 'anlage3_file_review' anlage.pk as edit_url %}
{% elif anlage.anlage_nr == 4 %}
  {% url 'anlage4_review' anlage.pk as edit_url %}
{% elif anlage.anlage_nr == 5 %}
  {% url 'anlage5_review' anlage.pk as edit_url %}
{% elif anlage.anlage_nr == 6 %}
  {% url 'anlage6_review' anlage.pk as edit_url %}
{% else %}
  {% url 'projekt_file_edit_json' anlage.pk as edit_url %}
{% endif %}

<div id="anlage-edit-{{ anlage.pk }}" hx-swap="outerHTML"
    {% if anlage.processing_status == 'PROCESSING' or anlage.processing_status == 'PENDING' or anlage.is_verification_running %}
        hx-get="{% url 'hx_anlage_status' anlage.pk %}"
        hx-trigger="load, every 5s"
    {% endif %}>

{% if anlage.processing_status == 'PROCESSING' or anlage.is_verification_running %}
<span class="inline-block px-1 py-0.5 rounded bg-gray-500 text-background text-sm opacity-50 pointer-events-none">{% include 'partials/spinner.html' %} Analyse l√§uft...</span>
{% elif anlage.processing_status == 'COMPLETE' %}
{% include 'partials/_button.html' with href=edit_url label='Analyse bearbeiten' variant='primary' classes='px-1 py-0.5 text-sm' %}
<form method="post" action="{% url 'trigger_file_analysis' anlage.pk %}" class="inline ml-2">
  {% csrf_token %}
  {% include 'partials/_button.html' with type='submit' label="<i class='fa-solid fa-sync-alt'></i>"|safe variant='primary' classes='px-1 py-0.5 text-sm' attrs='title="Erneut analysieren"' %}
</form>
{% elif anlage.processing_status == 'FAILED' %}
<span class="text-error mr-2">Analyse fehlgeschlagen</span>
<form method="post" action="{% url 'trigger_file_analysis' anlage.pk %}" class="inline">
  {% csrf_token %}
  {% include 'partials/_button.html' with type='submit' label='Erneut versuchen' variant='primary' classes='px-1 py-0.5 text-sm' %}
</form>
{% else %}
<form method="post" action="{% url 'trigger_file_analysis' anlage.pk %}" class="inline">
  {% csrf_token %}
  {% include 'partials/_button.html' with type='submit' label='Analyse starten' variant='primary' classes='px-1 py-0.5 text-sm' %}
</form>
{% endif %}

</div>

