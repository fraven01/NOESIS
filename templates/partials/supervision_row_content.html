<div class="p-2 space-y-4">
  {% for f in row.fields.values %}
  <div class="border rounded bg-white p-2 space-y-2">
    <h3 class="font-semibold">{{ f.label }}</h3>
    <div class="border rounded bg-gray-50 p-2 space-y-1">
      <h4 class="font-semibold">Parser</h4>
      <p>{{ f.doc_val|yesno:"Vorhanden,Nicht vorhanden,?" }}</p>
      {% if f.doc_reason %}
      <pre class="whitespace-pre-wrap bg-gray-100 p-2 rounded">{{ f.doc_reason }}</pre>
      {% endif %}
    </div>
    <div class="border rounded bg-blue-50 p-2 space-y-1">
      <h4 class="font-semibold">KI</h4>
      <p>{{ f.ai_val|yesno:"Vorhanden,Nicht vorhanden,?" }}</p>
      {% if f.ai_reason %}
      <p class="whitespace-pre-wrap bg-gray-100 p-2 rounded">{{ f.ai_reason }}</p>
      {% endif %}
    </div>
    <div class="border rounded bg-gray-50 p-2 space-y-1">
      <h4 class="font-semibold">Manuell</h4>
      <p>{{ f.final_val|yesno:"Vorhanden,Nicht vorhanden,?" }}</p>
    </div>
  </div>
  {% endfor %}
  <div class="border rounded bg-white p-2 space-y-2">
    <form hx-post="{% url 'hx_supervision_confirm' row.result_id %}" hx-target="closest details" hx-swap="outerHTML" class="inline">
      <button class="bg-green-600 text-white px-2 py-1 rounded" type="submit">GAP bestätigen</button>
    </form>
    <div class="space-x-2">
      {% for note in standard_notes %}
      <button type="button"
              hx-post="{% url 'hx_supervision_add_standard_note' row.result_id %}"
              hx-vals='{"note_text": "{{ note.note_text }}"}'
              hx-target="closest details" hx-swap="outerHTML"
              class="bg-gray-200 px-2 py-1 rounded">
        {{ note.note_text }}
      </button>
      {% endfor %}
    </div>
    <form hx-post="{% url 'hx_supervision_save_notes' row.result_id %}" hx-target="closest details" hx-swap="outerHTML" class="space-y-2">
      <textarea name="notes" rows="2" class="border rounded w-full p-2">{{ row.notes }}</textarea>
      <div class="space-x-2">
        <button type="submit" class="bg-blue-600 text-white px-2 py-1 rounded">Speichern</button>
        <button type="button"
                hx-post="{% url 'hx_supervision_revert_to_document' row.result_id %}"
                hx-target="closest details" hx-swap="outerHTML"
                class="bg-gray-300 px-2 py-1 rounded">
          GAP auflösen
        </button>
      </div>
    </form>
  </div>
</div>
